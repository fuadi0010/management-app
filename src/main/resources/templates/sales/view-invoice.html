<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Detail Invoice</title>
    <link rel="stylesheet" href="/css/sales.css">
</head>
<body>
    <div class="page-header">
        <h1>Detail Invoice Penjualan</h1>
    </div>
    
    <main class="container">
        <div class="main-container">
            <!-- Back Button -->
            <a th:href="@{/sales/list(role=${userRole})}" class="back-btn">
                ← Kembali ke Daftar Invoice
            </a>
            
            <!-- Role Badge -->
            <div class="role-badge" style="margin-bottom: var(--spacing-lg);">
                Role: <strong th:text="${userRole}"></strong>
            </div>
            
            <!-- Invoice Details -->
            <div class="invoice-detail">
                <div class="detail-grid">
                    <div class="detail-item">
                        <strong>No. Invoice</strong>
                        <span data-invoice-number th:text="${invoice.invoiceNumber}"></span>
                    </div>
                    
                    <div class="detail-item">
                        <strong>Customer</strong>
                        <span th:text="${invoice.customerName}"></span>
                    </div>
                    
                    <div class="detail-item">
                        <strong>Tanggal</strong>
                        <span th:text="${#temporals.format(invoice.invoiceDate, 'dd-MM-yyyy')}"></span>
                    </div>
                    
                    <div class="detail-item">
                        <strong>Pajak</strong>
                        <span th:text="${invoice.vatPercentage} + '%'"></span>
                    </div>
                    
                    <div class="detail-item">
                        <strong>Total</strong>
                        <span class="currency" th:text="${#numbers.formatDecimal(invoice.totalSales, 0, 'COMMA', 2, 'POINT')}"></span>
                    </div>
                    
                    <div class="detail-item">
                        <strong>Status</strong>
                        <span th:classappend="'status-badge status-' + ${invoice.salesStatus?.toString()?.toLowerCase()}"
                              th:text="${invoice.salesStatus}">
                        </span>
                    </div>
                </div>
                
                <!-- Product Details -->
                <h3 class="mt-4 mb-3">Detail Produk</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Produk</th>
                            <th>Quantity</th>
                            <th>Harga Jual</th>
                            <th>Subtotal</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="detail : ${invoice.invoiceDetails}">
                            <td th:text="${detail.product.productName}"></td>
                            <td class="text-right" th:text="${detail.quantity}"></td>
                            <td class="currency text-right" th:text="${#numbers.formatDecimal(detail.unitSellingPrice, 0, 'COMMA', 2, 'POINT')}"></td>
                            <td class="currency text-right" th:text="${#numbers.formatDecimal(detail.subtotal, 0, 'COMMA', 2, 'POINT')}"></td>
                        </tr>
                        <tr th:if="${#lists.isEmpty(invoice.invoiceDetails)}">
                            <td colspan="4" class="empty-state">Tidak ada detail produk</td>
                        </tr>
                    </tbody>
                </table>
                
                <!-- Action Buttons -->
                <div class="btn-group mt-4">
                    <a th:href="@{/sales/list(role=${userRole})}" class="btn btn-secondary">
                        ← Kembali ke Daftar
                    </a>
                    
                    <a th:href="@{/sales/complete/{id}(id=${invoice.id}, role=${userRole})}"
                       th:if="${invoice.salesStatus?.toString() == 'CREATED'}"
                       class="btn btn-warning">Selesaikan Invoice</a>
                    
                    <a th:href="@{/sales/cancel/{id}(id=${invoice.id}, role=${userRole})}"
                       th:if="${invoice.salesStatus?.toString() != 'CANCELLED'}"
                       class="btn btn-danger">Batalkan Invoice</a>
                </div>
            </div>
        </div>
    </main>
    
    <script src="/js/sales.js"></script>
</body>
</html>